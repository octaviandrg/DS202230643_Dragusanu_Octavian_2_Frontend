{"ast":null,"code":"'use strict';\n\nvar Lib = require('../../lib');\n\nvar attributes = require('./attributes');\n\nvar constants = require('./constants');\n\nvar dataUri = require('../../snapshot/helpers').IMAGE_URL_PREFIX;\n\nmodule.exports = function supplyDefaults(traceIn, traceOut) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(traceIn, traceOut, attributes, attr, dflt);\n  }\n\n  coerce('source'); // sanitize source to only allow for data URI representing images\n\n  if (traceOut.source && !traceOut.source.match(dataUri)) delete traceOut.source;\n  traceOut._hasSource = !!traceOut.source;\n  var z = coerce('z');\n  traceOut._hasZ = !(z === undefined || !z.length || !z[0] || !z[0].length);\n\n  if (!traceOut._hasZ && !traceOut._hasSource) {\n    traceOut.visible = false;\n    return;\n  }\n\n  coerce('x0');\n  coerce('y0');\n  coerce('dx');\n  coerce('dy');\n  var cm;\n\n  if (traceOut._hasZ) {\n    coerce('colormodel', 'rgb');\n    cm = constants.colormodel[traceOut.colormodel];\n    coerce('zmin', cm.zminDflt || cm.min);\n    coerce('zmax', cm.zmaxDflt || cm.max);\n  } else if (traceOut._hasSource) {\n    traceOut.colormodel = 'rgba256';\n    cm = constants.colormodel[traceOut.colormodel];\n    traceOut.zmin = cm.zminDflt;\n    traceOut.zmax = cm.zmaxDflt;\n  }\n\n  coerce('zsmooth');\n  coerce('text');\n  coerce('hovertext');\n  coerce('hovertemplate');\n  traceOut._length = null;\n};","map":null,"metadata":{},"sourceType":"script"}